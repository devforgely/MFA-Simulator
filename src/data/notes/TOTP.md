### Time-based One-Time Password

A single-factor OTP device generates OTPs. This category includes hardware devices and software-based OTP generators installed on devices such as mobile phones. These devices have an embedded secret that is used as the seed for generation of OTPs and does not require activation through a second factor. The OTP is displayed on the device and manually input for transmission to the verifier, thereby proving possession and control of the device. An OTP device may, for example, display 6 characters at a time. A single-factor OTP device is something you have.

Single-factor OTP devices are similar to look-up secret authenticators with the exception that the secrets are cryptographically and independently generated by the authenticator and verifier and compared by the verifier. The secret is computed based on a nonce that may be time-based or from a counter on the authenticator and verifier.

---

1. Generate 16-character, base32-encoded seed
2. The current time must be hashed together with the shared key to make the passcode constantly change the hash digest.
3. The protocol establishes a time step (default value of 30s) for the passcode to be updated.
4. The number of time steps T is hashed together with the seed.
5. The RFC6238 protocol uses HMAC-SHA-1 by default.

As specified in RFC 4226, we first look at the last character of the hash to determine a starting point for our truncated hash.
For example So we grab the next 31 bits, starting with offset 1 on SHA-1 Hash (9acf2f7d742997c8e39912959a1cf4fc12f28261)
Truncated value from the original hash is cf2f7d74. To get the TOTP we just have to convert it to decimal and show the last d digits by calculating the modulo 10<sup>d</sup> of the string.

